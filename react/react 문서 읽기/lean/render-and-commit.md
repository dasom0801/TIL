# Render and Commit

https://react.dev/learn/render-and-commit

- 컴포넌트가 화면에 보이기 전에 리액트에 의해서 렌더링 되어야 한다.
- UI를 요청하고 제공하는 과정
  1. 렌더링 트리거 (손님의 주문을 주방에 전달)
  2. 렌더링 컴포넌트 (주방에서 주문 준비)
  3. DOM에 커밋 (주문을 테이블에 배치)

## Step1: Trigger a render

컴포넌트가 렌더링되는 이유

1. 컴포넌트의 초기 렌더링
2. 컴포넌트 (혹은 컴포넌트의 조상중 하나)의 상태가 갱신됨

### 초기 렌더링

- 컴포넌트가 시작되면 초기 렌더링을 트리거해야한다.
- 타켓 DOM 노드로 createRoot를 호출한 다음 컴포넌트와 함께 render를 호출한다.

```tsx
import Image from './Image.js';
import { createRoot } from 'react-dom/client';

const root = createRoot(document.getElementById('root'));
root.render(<Image />);
```

### 상태 갱신되면 리렌더링

- 초기 렌더링이 된 이후에는 `set` 함수로 상태를 업데이트하는 것으로 추가적인 렌더링을 트리거할 수 있다.
- 컴포넌트의 상태를 갱신하면 렌더링이 자동으로 큐에 추가된다.

## Step2: React renders your components

- 렌더링을 트리거 한 후 React는 컴포넌트를 호출하여 화면에 표시할 내용을 파악한다. ‘렌더링’은 리액트가 컴포넌트를 호출하는 것이다.
- 초기 렌더링에서 React는 루트 컴포넌트를 호출한다.
- 초기 렌더링 이후에는 React는 상태 업데이트가 렌더링을 트리거한 함수 컴포넌트를 호출한다.
- 리액트는 렌더링을 재귀적으로 수행한다.
  - 업데이트된 컴포넌트가 다른 컴포넌트를 반환하면 React는 그 컴포넌트를 다음에 렌더링하고, 그 컴포넌트가 무언가를 반환하면 그 컴포넌트를 다음에 렌더링하는 식. 중첩된 컴포넌트가 더 이상 존재하지 않을 때 까지 계속하여 React는 화면에 표시해야 할 내용을 정확히 파악한다.
- 리렌더링할 때 React는 이전 렌더링으로부터 프로퍼티가 달라진 게 있는지 계산한다. 다음 단계인 커밋까지 해당 정보로 아무 작업도 수행하지 않는다.
- 렌더링은 항상 순수한 계산이어야 한다.
  - 동일한 입력이 주어지면 동일한 아웃풋이 나와야 한다.
  - 컴포넌트는 자기 일에 신경쓴다.렌더링 전에 존재했던 객체나 변수를 변경해서는 안 된다.

## Step3: React commits changes to the DOM

- 컴포넌트를 렌더링한 다음에 DOM을 수정한다.
- 초기 렌더링: React는 `appendChild()` DOM API를 이용해서 생성한 모든 DOM 노드를 화면에 배치한다.
- 리렌더링: React는 DOM이 최신 렌더링 아웃풋과 일치하도록 하기 위해 최소한의 연산 (렌더링중에 계산)을 적용한다.
- React는 렌더링 간에 차이가 있는 경우에만 DOM node를 변경한다.

## 브라우저 페인트 (브라우저 렌더링)

- 렌더링이 완료되고 React가 DOM을 업데이트하면 브라우저가 화면을 다시 그린다.
